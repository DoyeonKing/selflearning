# Word2Vec 模型文件下载和转换指南

## 🎯 好消息：现在支持 .txt 格式了！

我已经修改了代码，现在**同时支持 `.bin` 和 `.txt` 格式**的模型文件。您不需要自己生成 `.bin` 文件了！

---

## 📥 方案1：直接下载 .txt 格式模型（最简单）

### 推荐下载地址

1. **中文词向量 GitHub 仓库**
   - 地址：https://github.com/Embedding/Chinese-Word-Vectors
   - 在仓库中找到 `Word_Character_Embeddings` 目录
   - 下载 `.txt` 格式的文件（比 `.bin` 更容易找到）

2. **具体推荐文件**：
   - `sgns.zhihu.word.txt` - 知乎语料（推荐）
   - `sgns.weibo.word.txt` - 微博语料
   - `sgns.wiki.word.txt` - 维基百科语料
   - `sgns.renmin.word.txt` - 人民日报语料

### 操作步骤

1. **下载 .txt 文件**
   - 从上述地址下载任意一个 `.txt` 格式的模型文件
   - 文件通常较大（200MB - 1GB）

2. **重命名文件**
   - 将下载的文件重命名为：`medical_word2vec.txt`
   - 或者保持原文件名，修改配置文件

3. **放置文件**
   - 放到 `springboot/models/` 目录下
   - 最终路径：`springboot/models/medical_word2vec.txt`

4. **修改配置文件**（如果文件名不是 `medical_word2vec.txt`）
   
   在 `application.yml` 中修改：
   ```yaml
   ai:
     model:
       path: models/medical_word2vec.txt  # 改为 .txt
   ```

---

## 🔄 方案2：使用现有 .txt 文件转换（如果需要 .bin）

如果您已经有 `.txt` 格式的文件，想转换为 `.bin` 格式，可以使用以下 Python 脚本：

### 转换脚本

创建文件：`convert_txt_to_bin.py`

```python
#!/usr/bin/env python
# -*- coding: utf-8 -*-
"""
将 Word2Vec .txt 格式转换为 .bin 格式
需要安装：pip install gensim
"""

from gensim.models import KeyedVectors
import sys

def convert_txt_to_bin(txt_path, bin_path):
    """
    将 .txt 格式转换为 .bin 格式
    
    Args:
        txt_path: 输入的 .txt 文件路径
        bin_path: 输出的 .bin 文件路径
    """
    print(f"正在加载 {txt_path}...")
    
    # 加载文本格式的模型
    # 注意：.txt 格式通常是 "word v1 v2 v3 ..." 格式
    model = KeyedVectors.load_word2vec_format(txt_path, binary=False)
    
    print(f"词汇量: {len(model)}")
    print(f"向量维度: {model.vector_size}")
    
    print(f"正在保存为二进制格式: {bin_path}...")
    # 保存为二进制格式
    model.save_word2vec_format(bin_path, binary=True)
    
    print("✅ 转换完成！")

if __name__ == "__main__":
    if len(sys.argv) != 3:
        print("用法: python convert_txt_to_bin.py <输入.txt> <输出.bin>")
        print("示例: python convert_txt_to_bin.py model.txt model.bin")
        sys.exit(1)
    
    txt_path = sys.argv[1]
    bin_path = sys.argv[2]
    
    convert_txt_to_bin(txt_path, bin_path)
```

### 使用方法

```bash
# 安装依赖
pip install gensim

# 运行转换
python convert_txt_to_bin.py springboot/models/medical_word2vec.txt springboot/models/medical_word2vec.bin
```

---

## 🚀 方案3：直接使用降级模式（无需模型文件）

**最简单的方式：暂时不下载模型文件！**

系统已经支持自动降级：
- ✅ 没有模型文件时，系统自动使用关键词匹配模式
- ✅ 所有功能仍然可用
- ✅ 不会报错
- ⚠️ 只是没有 AI 语义理解能力

**您可以：**
1. 先不下载模型，测试基本功能
2. 确认系统运行正常后，再考虑下载模型文件
3. 或者永远使用降级模式（如果关键词匹配已经够用）

---

## 📋 文件格式说明

### .txt 格式示例

```
词汇量 维度
词1 0.123 0.456 0.789 ...
词2 0.234 0.567 0.890 ...
...
```

第一行通常是：`词汇量 维度`（例如：`100000 200`）
后续每行：`词 向量值1 向量值2 ...`

### .bin 格式

二进制格式，文件更小，加载更快，但需要转换。

---

## ✅ 验证模型加载

启动项目后，查看日志：

**成功加载 .txt 格式：**
```
📝 找到 .txt 格式模型，使用: models/medical_word2vec.txt
⏳ 正在加载 AI 语义模型: models/medical_word2vec.txt (预计耗时 2-5 秒)...
✅ AI 模型加载成功！词汇量: XXXXXX
```

**成功加载 .bin 格式：**
```
⏳ 正在加载 AI 语义模型: models/medical_word2vec.bin (预计耗时 2-5 秒)...
✅ AI 模型加载成功！词汇量: XXXXXX
```

**降级模式：**
```
⚠️ 未找到模型文件: models/medical_word2vec.bin (也尝试了 .txt 格式)。系统将自动降级为【纯关键词匹配模式】。
```

---

## 🎯 推荐方案

**对于您的情况，我推荐：**

1. **立即方案**：先不下载模型，使用降级模式测试系统
2. **后续方案**：从 GitHub 下载 `.txt` 格式的模型文件（更容易找到）
3. **长期方案**：如果效果满意，可以保持使用 `.txt` 格式，或者转换为 `.bin` 格式以提升加载速度

---

## 📚 资源链接

1. **Chinese-Word-Vectors GitHub**
   - https://github.com/Embedding/Chinese-Word-Vectors
   - 包含多种格式的预训练模型

2. **腾讯词向量**（需要注册）
   - https://ai.tencent.com/ailab/nlp/zh/embedding.html

3. **其他中文词向量资源**
   - 搜索 "Chinese Word Vectors" 或 "中文词向量"

---

## ❓ 常见问题

**Q: .txt 和 .bin 格式有什么区别？**
A: 
- `.txt` 格式：文本格式，容易查看和编辑，但加载稍慢
- `.bin` 格式：二进制格式，加载更快，文件更小

**Q: 两种格式效果一样吗？**
A: 是的，效果完全一样，只是存储格式不同。

**Q: 我应该用哪种格式？**
A: 
- 如果容易找到 `.txt` 文件，直接用 `.txt`（更简单）
- 如果追求性能，可以转换为 `.bin`（加载更快）

**Q: 模型文件必须下载吗？**
A: 不是必须的。系统支持降级模式，没有模型文件也能运行。


