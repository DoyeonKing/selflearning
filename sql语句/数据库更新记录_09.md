# 数据库更新记录 - 09

## 更新时间
2024年（根据实际执行时间填写）

## 更新内容

### 1. 清空 schedules 表
- 删除所有排班记录
- 为了保持数据完整性，先删除了关联的 appointments（预约）记录

### 2. 更新 time_slots 表
原有的时间段数据已清空，新插入以下4条时间段记录：

| slot_id | slot_name | start_time | end_time |
|---------|-----------|------------|----------|
| 1 | 上午 08:00-12:00 | 08:00:00 | 12:00:00 |
| 2 | 上午 08:30-12:00 | 08:30:00 | 12:00:00 |
| 3 | 下午 14:00-18:00 | 14:00:00 | 18:00:00 |
| 4 | 下午 14:30-18:00 | 14:30:00 | 18:00:00 |

## 执行脚本
文件路径：`sql语句/09_update_timeslots_and_clear_schedules.sql`

## 验证结果

### time_slots 表
```sql
SELECT * FROM time_slots ORDER BY slot_id;
```
结果：成功插入4条记录

### schedules 表
```sql
SELECT COUNT(*) as schedule_count FROM schedules;
```
结果：0（已清空）

## 注意事项

1. **数据备份**：执行前建议备份相关表的数据
2. **依赖关系**：
   - schedules 表依赖 time_slots 表
   - appointments 表依赖 schedules 表
   - 删除顺序：appointments → schedules → time_slots → 重新插入 time_slots
3. **后续操作**：需要重新创建排班数据（schedules）才能使用系统

## 影响范围

1. **前端排班管理页面**：时间段下拉框将显示新的4个时间段
2. **排班创建/编辑功能**：只能选择这4个时间段
3. **预约功能**：由于 schedules 表已清空，暂时无法预约
4. **历史数据**：所有历史排班和预约记录已被删除

## 恢复方法

如果需要恢复到更新前的状态：
1. 从备份文件恢复 appointments、schedules、time_slots 表
2. 或执行 `01_tables/建表语句(1).sql` 重建初始数据


